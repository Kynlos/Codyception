<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>JSON Viewer</title>
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <!-- Font Awesome CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
  <style>
    body {
      background-color: #343a40; /* Dark mode background color */
      color: #ffffff; /* Dark mode text color */
      margin-top: 50px;
    }
    .container {
      border-radius: 15px; /* Rounded corners for the container */
      overflow: hidden; /* Ensure rounded corners are applied */
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); /* Box shadow for a subtle lift */
    }
    table {
      border-radius: 15px; /* Rounded corners for the table */
      overflow: hidden; /* Ensure rounded corners are applied */
    }
    .form-group {
      margin-bottom: 15px;
    }
    .pagination {
      margin-top: 15px;
    }
    .page-link {
      color: #ffffff; /* Dark mode text color for pagination links */
      background-color: #495057; /* Dark mode background color for pagination links */
      border-color: #495057; /* Dark mode border color for pagination links */
    }
    .page-link:hover {
      background-color: #6c757d; /* Dark mode background color on hover for pagination links */
      border-color: #6c757d; /* Dark mode border color on hover for pagination links */
    }
    .disabled {
      cursor: not-allowed;
      pointer-events: none;
    }
  </style>
</head>
<body>

<div class="container">
  <!-- Search Input -->
  <div class="form-group">
    <label for="search" style="color: #ffffff;">Search:</label>
    <input type="text" class="form-control" id="search" oninput="searchTable()" style="color: #ffffff; background-color: #495057;">
  </div>

  <!-- Items Per Page Dropdown -->
  <div class="form-group">
    <label for="itemsPerPage" style="color: #ffffff;">Items per Page:</label>
    <select class="form-control" id="itemsPerPage" onchange="changeItemsPerPage()" style="color: #ffffff; background-color: #495057;">
      <option value="10">10</option>
      <option value="20">20</option>
      <option value="50">50</option>
    </select>
  </div>

  <!-- Pagination Controls -->
  <nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
      <li class="page-item" id="prevPage">
        <a class="page-link" href="#" aria-label="Previous" onclick="changePage(-1)">
          <span aria-hidden="true">&laquo;</span>
        </a>
      </li>
      <li class="page-item" id="nextPage">
        <a class="page-link" href="#" aria-label="Next" onclick="changePage(1)">
          <span aria-hidden="true">&raquo;</span>
        </a>
      </li>
    </ul>
  </nav>

  <table class="table table-bordered table-dark">
    <thead class="thead-dark">
      <tr>
        <th>Command</th>
        <th>Description</th>
        <th>Prompt</th>
        <th>Context</th>
      </tr>
    </thead>
    <tbody id="jsonTableBody"></tbody>
  </table>
</div>

<!-- Bootstrap JS and Popper.js -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


<script>
  // Additional functions for pagination, items per page, and search
  var jsonData; // Variable to store the fetched JSON data
  var currentPage = 1;
  var itemsPerPage = 10; // Set the initial items per page to 10
  var commandArray; // Declare commandArray here

  // Function to fetch JSON data
  async function fetchJsonData() {
    try {
      const response = await fetch('Cody.json'); // Replace with the actual path
      const jsonData = await response.json();
      return jsonData;
    } catch (error) {
      console.error('Error fetching JSON data:', error);
    }
  }

  // Function to populate the table with JSON data
  async function populateTable() {
    jsonData = await fetchJsonData();
    if (!jsonData || !jsonData.commands) {
      console.error('Invalid JSON data. Expected "commands" property.');
      return;
    }

    // Extract commands from the jsonData object
    const commands = jsonData.commands;

    // Convert commands object into an array
    commandArray = Object.entries(commands).map(([command, details]) => ({
      command,
      ...details,
    }));

    // Apply pagination and items per page logic
    const startIndex = (currentPage - 1) * itemsPerPage;
    const endIndex = startIndex + itemsPerPage;

    // Use slice to get the desired items for the current page
    const filteredData = commandArray.slice(startIndex, endIndex);

    // Display the filtered data in the table
    var tableBody = document.getElementById('jsonTableBody');
    tableBody.innerHTML = ''; // Clear existing rows
    filteredData.forEach(function (item) {
      var row = tableBody.insertRow();
      var cell1 = row.insertCell(0);
      var cell2 = row.insertCell(1);
      var cell3 = row.insertCell(2);
      var cell4 = row.insertCell(3);

      cell1.innerHTML = item.command;
      cell2.innerHTML = item.description;
      cell3.innerHTML = item.prompt;
      cell4.innerHTML = JSON.stringify(item.context);
    });

    // Update pagination controls
    updatePagination();
  }

  // Update table based on selected items per page
  function changeItemsPerPage() {
    itemsPerPage = parseInt(document.getElementById('itemsPerPage').value);
    currentPage = 1;
    populateTable();
  }

  // Update table based on pagination
  function updatePagination() {
    document.getElementById('prevPage').classList.toggle('disabled', currentPage === 1);
    document.getElementById('nextPage').classList.toggle('disabled', currentPage === Math.ceil(commandArray.length / itemsPerPage));
  }

  // Update table based on search input
  function searchTable() {
    var searchTerm = document.getElementById('search').value.toLowerCase();
    const filteredData = commandArray.filter(function (item) {
      return (
        item.command.toLowerCase().includes(searchTerm) ||
        item.description.toLowerCase().includes(searchTerm) ||
        item.prompt.toLowerCase().includes(searchTerm) ||
        JSON.stringify(item.context).toLowerCase().includes(searchTerm)
      );
    });

    currentPage = 1;

    // Display the filtered data in the table
    var tableBody = document.getElementById('jsonTableBody');
    tableBody.innerHTML = ''; // Clear existing rows
    filteredData.forEach(function (item) {
      var row = tableBody.insertRow();
      var cell1 = row.insertCell(0);
      var cell2 = row.insertCell(1);
      var cell3 = row.insertCell(2);
      var cell4 = row.insertCell(3);

      cell1.innerHTML = item.command;
      cell2.innerHTML = item.description;
      cell3.innerHTML = item.prompt;
      cell4.innerHTML = JSON.stringify(item.context);
    });

    // Update pagination controls
    updatePagination();
  }

  // Change page function
  function changePage(delta) {
    currentPage += delta;
    populateTable();
  }

  // Call the function to populate the table
  populateTable();
</script>

</body>
</html>
